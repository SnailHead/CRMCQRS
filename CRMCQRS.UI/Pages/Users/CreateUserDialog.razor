@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Authorization
@using MudBlazor
@using CRMCQRS.Infrastructure.Authentication.Policies
@attribute [Authorize(Policy = $"{Policy.Developer},{Policy.Admin},{Policy.DepartmentHead}")]

<PageTitle>Пользователи</PageTitle>

<MudForm Model="@Model" @ref="@_form" Validation="@(_validator.ValidateValue)" ValidationDelay="0">
    <MudDialog>
        <DialogContent>
            <MudContainer Class="overflow-scroll" Style="max-height: 500px">

                <MudGrid>
                    <MudItem md="6" sm="12" xs="12">
                        <MudTextField @bind-Value="Model.Firstname" For="@(() => Model.Firstname)" Immediate="true" Label="Имя"/>
                    </MudItem>
                    <MudItem md="6" sm="12" xs="12">
                        <MudTextField @bind-Value="Model.Lastname" For="@(() => Model.Lastname)" Immediate="true" Label="Фамилия"/>
                    </MudItem>
                    <MudItem md="6" sm="12" xs="12">
                        <MudTextField @bind-Value="Model.Middlename" For="@(() => Model.Middlename)" Immediate="true" Label="Отчество"/>
                    </MudItem>
                    <MudItem md="6" sm="12" xs="12">
                        <MudTextField @bind-Value="Model.Password" For="@(() => Model.Password)" Immediate="true" Label="Пароль"/>
                    </MudItem>
                    <MudItem md="6" sm="12" xs="12">
                        <MudTextField @bind-Value="Model.Email" For="@(() => Model.Email)" Immediate="true" Label="Почта"/>
                    </MudItem>
                    <MudItem md="6" sm="12" xs="12">
                        <MudTextField @bind-Value="Model.BirthDate" For="@(() => Model.BirthDate)" Format="yyyy-MM-dd" Immediate="true" InputType="InputType.Date" Label="Дата рождения" T="DateTime?"/>
                    </MudItem>
                    <MudItem md="6" sm="12" xs="12">

                        <MudTextField @bind-Value="Model.TelegramChatId" For="@(() => Model.TelegramChatId)" Immediate="true" Label="Телеграм чат ID"/>
                    </MudItem>

                </MudGrid>
            </MudContainer>

        </DialogContent>
        <DialogActions>
            <MudButton Class="ml-auto" Color="Color.Primary" OnClick="@(async () => await Submit())" Variant="Variant.Filled">Сохранить</MudButton>
            <MudButton OnClick="Cancel">Отмена</MudButton>
        </DialogActions>
    </MudDialog>

</MudForm>